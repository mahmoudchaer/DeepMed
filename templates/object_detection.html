{% extends "base.html" %}

{% block title %}DeepMed - Object Detection{% endblock %}

{% block content %}
<div class="card shadow">
    <div class="card-body">
        <h1 class="mb-4">Object Detection - YOLOv5</h1>
        
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="alert alert-info">
                    <h4>Fine-tune YOLOv5 for Object Detection</h4>
                    <p>Upload a ZIP file with your dataset in YOLOv5 format to fine-tune a pre-trained YOLOv5 model.</p>
                    <p>The dataset should include a data.yaml file and image folders with annotations.</p>
                    <p><strong>Note:</strong> Fine-tuning is computationally intensive and may take several minutes.</p>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-lg-6">
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">Upload Dataset & Configure Training</h5>
                    </div>
                    <div class="card-body">
                        <form id="yoloForm" enctype="multipart/form-data">
                            <div class="mb-3">
                                <label for="zipFile" class="form-label">Dataset ZIP File</label>
                                <input type="file" class="form-control" id="zipFile" name="zipFile" accept=".zip" required>
                                <div class="form-text">ZIP file containing your YOLOv5 dataset (images, labels, data.yaml)</div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="level" class="form-label">Training Level</label>
                                <select class="form-select" id="level" name="level">
                                    <option value="1">Level 1 - Fast (Nano model, 20 epochs, lower resolution)</option>
                                    <option value="2">Level 2 - Standard (Small model, 30 epochs, medium resolution)</option>
                                    <option value="3" selected>Level 3 - Balanced (Small model, 50 epochs, full resolution)</option>
                                    <option value="4">Level 4 - Extended (Medium model, 80 epochs, full resolution)</option>
                                    <option value="5">Level 5 - Advanced (Large model, 100 epochs, full resolution)</option>
                                </select>
                                <div class="form-text">Higher levels produce better models but take longer to train</div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary" id="submitBtn">Fine-tune Model</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">Training Process</h5>
                    </div>
                    <div class="card-body">
                        <div id="statusBox" class="d-none">
                            <div class="alert alert-info mb-3">
                                <span id="statusMessage">Processing... This may take several minutes.</span>
                            </div>
                            
                            <div id="resultMessage" class="d-none">
                                <div class="alert alert-success">
                                    <p class="mb-1">Training complete! <a id="downloadLink" href="#" class="alert-link">Download YOLOv5 model</a></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">YOLOv5 Dataset Format</h5>
                    </div>
                    <div class="card-body">
                        <p>Your dataset ZIP should have this structure:</p>
                        <pre class="bg-light p-3 small">
dataset/
├── data.yaml     # Dataset config
├── train/        # Training images
│   ├── images/   # JPG files
│   └── labels/   # TXT files (YOLO format)
└── val/          # Validation images (used for testing)
    ├── images/   # JPG files
    └── labels/   # TXT files (YOLO format)
</pre>
                        <p>The <code>data.yaml</code> file should define:</p>
                        <pre class="bg-light p-3 small">
path: ../dataset  # dataset root dir
train: train/images  # train images
val: val/images  # val images
nc: 3  # number of classes
names: ['person', 'car', 'dog']  # class names
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/object_detection.js"></script>
{% endblock %} 